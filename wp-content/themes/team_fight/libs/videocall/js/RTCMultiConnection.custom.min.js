"use strict";window.RTCMultiConnection=function(a,d){function f(s,e){var t="";t+="?userid="+s.userid,t+="&sessionid="+s.sessionid,t+="&msgEvent="+s.socketMessageEvent,t+="&socketCustomEvent="+s.socketCustomEvent,t+="&autoCloseEntireSession="+!!s.autoCloseEntireSession,!0===s.session.broadcast&&(t+="&oneToMany=true"),t+="&maxParticipantsAllowed="+s.maxParticipantsAllowed,s.enableScalableBroadcast&&(t+="&enableScalableBroadcast=true",t+="&maxRelayLimitPerUser="+(s.maxRelayLimitPerUser||2)),s.socketCustomParameters&&(t+=s.socketCustomParameters);try{io.sockets={}}catch(e){}if(s.socketURL||(s.socketURL="/"),"/"!=s.socketURL.substr(s.socketURL.length-1,1))throw'"socketURL" MUST end with a slash.';s.enableLogs&&("/"==s.socketURL?console.info("socket.io is connected at: ",location.origin+"/"):console.info("socket.io is connected at: ",s.socketURL));try{s.socket=io(s.socketURL+t)}catch(e){s.socket=io.connect(s.socketURL+t,s.socketOptions)}s.socket.isIO=!0;var a=s.multiPeersHandler;s.socket.on("extra-data-updated",function(e,t){s.peers[e]&&(s.peers[e].extra=t,s.onExtraDataUpdated({userid:e,extra:t}),s.peersBackup[e]||(s.peersBackup[e]={userid:e,extra:{}}),s.peersBackup[e].extra=t)}),s.socket.on(s.socketMessageEvent,function e(t){if(t.remoteUserId==s.userid)if(s.peers[t.sender]&&s.peers[t.sender].extra!=t.message.extra&&(s.peers[t.sender].extra=t.extra,s.onExtraDataUpdated({userid:t.sender,extra:t.extra})),"next-possible-initiator"!==t.message)if(t.message.streamSyncNeeded&&s.peers[t.sender]){var n=s.streamEvents[t.message.streamid];if(!n||!n.stream)return;var o=t.message.action;if("ended"===o||"inactive"===o||"stream-removed"===o)return s.peersBackup[n.userid]&&(n.extra=s.peersBackup[n.userid].extra),void s.onstreamended(n);var i="both"!=t.message.type?t.message.type:null;"function"==typeof n.stream[o]&&n.stream[o](i)}else{if("connectWithAllParticipants"===t.message)return-1===s.broadcasters.indexOf(t.sender)&&s.broadcasters.push(t.sender),void a.onNegotiationNeeded({allParticipants:s.getAllParticipants(t.sender)},t.sender);if("removeFromBroadcastersList"!==t.message)if("dropPeerConnection"!==t.message){if(t.message.allParticipants)return-1===t.message.allParticipants.indexOf(t.sender)&&t.message.allParticipants.push(t.sender),void t.message.allParticipants.forEach(function(e){a[s.peers[e]?"renegotiatePeer":"createNewPeer"](e,{localPeerSdpConstraints:{OfferToReceiveAudio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:s.session.oneway?!!s.session.audio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.session.oneway?!!s.session.video||!!s.session.screen:s.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!s.session.oneway||"one-way"===s.direction,isDataOnly:C(s.session)})});if(t.message.newParticipant){if(t.message.newParticipant==s.userid)return;if(s.peers[t.message.newParticipant])return;a.createNewPeer(t.message.newParticipant,t.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:s.session.oneway?!!s.session.audio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.session.oneway?!!s.session.video||!!s.session.screen:s.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!s.session.oneway||"one-way"===s.direction,isDataOnly:C(s.session)})}else{if(t.message.readyForOffer||t.message.addMeAsBroadcaster){if(s.attachStreams.length&&(s.waitingForLocalMedia=!1),s.waitingForLocalMedia)return void setTimeout(function(){e(t)},1e3);s.addNewBroadcaster(t.sender)}if(t.message.newParticipationRequest&&t.sender!==s.userid){s.peers[t.sender]&&s.deletePeer(t.sender);var r={extra:t.extra||{},localPeerSdpConstraints:t.message.remotePeerSdpConstraints||{OfferToReceiveAudio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:t.message.localPeerSdpConstraints||{OfferToReceiveAudio:s.session.oneway?!!s.session.audio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.session.oneway?!!s.session.video||!!s.session.screen:s.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:void 0!==t.message.isOneWay?t.message.isOneWay:!!s.session.oneway||"one-way"===s.direction,isDataOnly:void 0!==t.message.isDataOnly?t.message.isDataOnly:C(s.session),dontGetRemoteStream:void 0!==t.message.isOneWay?t.message.isOneWay:!!s.session.oneway||"one-way"===s.direction,dontAttachLocalStream:!!t.message.dontGetRemoteStream,connectionDescription:t,successCallback:function(){(void 0!==t.message.isOneWay?t.message.isOneWay:s.session.oneway||"one-way"===s.direction)&&s.addNewBroadcaster(t.sender,r),(s.session.oneway||"one-way"===s.direction||C(s.session))&&s.addNewBroadcaster(t.sender,r)}};s.onNewParticipant(t.sender,r)}else if(t.message.shiftedModerationControl)s.onShiftedModerationControl(t.sender,t.message.broadcasters);else{if(t.message.changedUUID&&s.peers[t.message.oldUUID]&&(s.peers[t.message.newUUID]=s.peers[t.message.oldUUID],delete s.peers[t.message.oldUUID]),t.message.userLeft)return a.onUserLeft(t.sender),void(t.message.autoCloseEntireSession&&s.leave());a.addNegotiatedMessage(t.message,t.sender)}}}else s.deletePeer(t.sender);else-1!==s.broadcasters.indexOf(t.sender)&&(delete s.broadcasters[s.broadcasters.indexOf(t.sender)],s.broadcasters=c(s.broadcasters))}else{if(s.nextPossibleInitiatorIfThisUserLeave)return;s.nextPossibleInitiatorIfThisUserLeave=t.sender}}),s.socket.on("user-left",function(e){onUserLeft(e),s.onUserStatusChanged({userid:e,status:"offline",extra:s.peers[e]&&s.peers[e].extra||{}});var t={userid:e,extra:{}};s.peersBackup[t.userid]&&(t.extra=s.peersBackup[t.userid].extra),s.onleave(t),s.nextPossibleInitiatorIfThisUserLeave===e&&(s.nextPossibleInitiatorIfThisUserLeave=null,s.open(s.sessionid))});var n=!1;s.socket.resetProps=function(){n=!1},s.socket.on("connect",function(){n||(n=!0,s.enableLogs&&console.info("socket.io connection is opened."),setTimeout(function(){s.socket.emit("extra-data-updated",s.extra),e&&e(s.socket)},1e3))}),s.socket.on("disconnect",function(){s.enableLogs&&console.warn("socket.io connection is closed")}),s.socket.on("join-with-password",function(e){s.onJoinWithPassword(e)}),s.socket.on("invalid-password",function(e,t){s.onInvalidPassword(e,t)}),s.socket.on("password-max-tries-over",function(e){s.onPasswordMaxTriesOver(e)}),s.socket.on("user-disconnected",function(e){e!==s.userid&&(s.onUserStatusChanged({userid:e,status:"offline",extra:s.peers[e]&&s.peers[e].extra||{}}),s.deletePeer(e))}),s.socket.on("user-connected",function(e){e!==s.userid&&s.onUserStatusChanged({userid:e,status:"online",extra:s.peers[e]&&s.peers[e].extra||{}})}),s.socket.on("closed-entire-session",function(e,t){s.leave(),s.onEntireSessionClosed({sessionid:e,userid:e,extra:t})}),s.socket.on("userid-already-taken",function(e,t){s.isInitiator=!1,s.userid=t,s.onUserIdAlreadyTaken(e,t)}),s.socket.on("logs",function(e){s.enableLogs&&console.debug("server-logs",e)}),s.socket.on("number-of-broadcast-viewers-updated",function(e){s.onNumberOfBroadcastViewersUpdated(e)}),s.socket.on("room-full",function(e){s.onRoomFull(e)}),s.socket.on("become-next-modrator",function(e){e==s.sessionid&&setTimeout(function(){s.open(e),s.socket.emit("shift-moderator-control-on-disconnect")},1e3)})}function p(r){var s=this,o=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];function i(){r.fbr=new FileBufferReader,r.fbr.onProgress=function(e){r.onFileProgress(e)},r.fbr.onBegin=function(e){r.onFileStart(e)},r.fbr.onEnd=function(e){r.onFileEnd(e)}}r.peersBackup={},r.peers={getLength:function(){var e=0;for(var t in this)-1==o.indexOf(t)&&e++;return e},selectFirst:function(){var e;for(var t in this)-1==o.indexOf(t)&&(e=this[t]);return e},getAllParticipants:function(e){var t=[];for(var n in this)-1==o.indexOf(n)&&n!=e&&t.push(n);return t},forEach:function(t){this.getAllParticipants().forEach(function(e){t(r.peers[e])})},send:function(t,e){var n=this;if(u(t.size)||u(t.type))if("text"===t.type||t instanceof ArrayBuffer||t instanceof DataView){if("text"===t.type&&(t=JSON.stringify(t)),e){var o=r.peers[e];if(o)return o.channels.length?void o.channels.forEach(function(e){e.send(t)}):(r.peers[e].createDataChannel(),r.renegotiate(e),void setTimeout(function(){n.send(t,e)},3e3))}this.getAllParticipants().forEach(function(e){if(!n[e].channels.length)return r.peers[e].createDataChannel(),r.renegotiate(e),void setTimeout(function(){n[e].channels.forEach(function(e){e.send(t)})},3e3);n[e].channels.forEach(function(e){e.send(t)})})}else B.send({text:t,channel:this,connection:r,remoteUserId:e});else s.shareFile(t,e)}},this.uuid=r.userid,this.getLocalConfig=function(e,n,t){return t||(t={}),{streamsToShare:t.streamsToShare||{},rtcMultiConnection:r,connectionDescription:t.connectionDescription,userid:n,localPeerSdpConstraints:t.localPeerSdpConstraints,remotePeerSdpConstraints:t.remotePeerSdpConstraints,dontGetRemoteStream:!!t.dontGetRemoteStream,dontAttachLocalStream:!!t.dontAttachLocalStream,renegotiatingPeer:!!t.renegotiatingPeer,peerRef:t.peerRef,channels:t.channels||[],onLocalSdp:function(e){s.onNegotiationNeeded(e,n)},onLocalCandidate:function(e){(e=m.processCandidates(r,e))&&s.onNegotiationNeeded(e,n)},remoteSdp:e,onDataChannelMessage:function(e){if(!r.fbr&&r.enableFileSharing&&i(),"string"!=typeof e&&r.enableFileSharing){var t=this;e instanceof ArrayBuffer||e instanceof DataView?r.fbr.convertToObject(e,function(e){t.onDataChannelMessage(e)}):e.readyForNextChunk?r.fbr.getNextChunk(e,function(t,e){r.peers[n].channels.forEach(function(e){e.send(t)})},n):e.chunkMissing?r.fbr.chunkMissing(e):r.fbr.addChunk(e,function(e){r.peers[n].peer.channel.send(e)})}else s.onDataChannelMessage(e,n)},onDataChannelError:function(e){s.onDataChannelError(e,n)},onDataChannelOpened:function(e){s.onDataChannelOpened(e,n)},onDataChannelClosed:function(e){s.onDataChannelClosed(e,n)},onRemoteStream:function(e){r.peers[n]&&r.peers[n].streams.push(e),s.onGettingRemoteMedia(e,n)},onRemoteStreamRemoved:function(e){s.onRemovingRemoteMedia(e,n)},onPeerStateChanged:function(e){s.onPeerStateChanged(e),"new"===e.iceConnectionState&&s.onNegotiationStarted(n,e),"connected"===e.iceConnectionState&&s.onNegotiationCompleted(n,e),-1!==e.iceConnectionState.search(/closed|failed/gi)&&(s.onUserLeft(n),s.disconnectWith(n))}}},this.createNewPeer=function(e,t){if(!(r.maxParticipantsAllowed<=r.getAllParticipants().length)){if(t=t||{},r.isInitiator&&r.session.audio&&"two-way"===r.session.audio&&!t.streamsToShare&&(t.isOneWay=!1,t.isDataOnly=!1,t.session=r.session),!t.isOneWay&&!t.isDataOnly)return t.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:t},e);t=r.setUserPreferences(t,e);var n=this.getLocalConfig(null,e,t);r.peers[e]=new l(n),this.checkIfNextPossibleInitiator(e)}},this.createAnsweringPeer=function(e,t,n){n=r.setUserPreferences(n||{},t);var o=this.getLocalConfig(e,t,n);r.peers[t]=new l(o),this.checkIfNextPossibleInitiator(t)},this.renegotiatePeer=function(e,t,n){if(r.peers[e]){t||(t={}),t.renegotiatingPeer=!0,t.peerRef=r.peers[e].peer,t.channels=r.peers[e].channels;var o=this.getLocalConfig(n,e,t);r.peers[e]=new l(o),this.checkIfNextPossibleInitiator(e)}else r.enableLogs&&console.error("Peer ("+e+") does not exist. Renegotiation skipped.")},this.replaceTrack=function(t,n,o){if(!r.peers[n])throw"This peer ("+n+") does not exist.";var e=r.peers[n].peer;e.getSenders&&"function"==typeof e.getSenders&&e.getSenders().length?e.getSenders().forEach(function(e){o&&e.track instanceof VideoStreamTrack&&(r.peers[n].peer.lastVideoTrack=e.track,e.replaceTrack(t)),!o&&e.track instanceof AudioStreamTrack&&(r.peers[n].peer.lastAudioTrack=e.track,e.replaceTrack(t))}):(console.warn("RTPSender.replaceTrack is NOT supported."),this.renegotiatePeer(n))},this.onNegotiationNeeded=function(e,t){},this.addNegotiatedMessage=function(e,t){if(e.type&&e.sdp)return"answer"==e.type&&r.peers[t]&&r.peers[t].addRemoteSdp(e),"offer"==e.type&&(e.renegotiatingPeer?this.renegotiatePeer(t,null,e):this.createAnsweringPeer(e,t)),void(r.enableLogs&&console.log("Remote peer's sdp:",e.sdp));if(e.candidate)return r.peers[t]&&r.peers[t].addRemoteCandidate(e),void(r.enableLogs&&console.log("Remote peer's candidate pairs:",e.candidate));if(e.enableMedia){r.session=e.userPreferences.session||r.session,r.session.oneway&&r.attachStreams.length&&(r.attachStreams=[]),e.userPreferences.isDataOnly&&r.attachStreams.length&&(r.attachStreams.length=[]);var n={};r.attachStreams.forEach(function(e){n[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),e.userPreferences.streamsToShare=n,s.onNegotiationNeeded({readyForOffer:!0,userPreferences:e.userPreferences},t)}e.readyForOffer&&r.onReadyForOffer(t,e.userPreferences)},this.connectNewParticipantWithAllBroadcasters=function(e,t,n){if(!r.socket.isIO&&(n=(n||"").split("|-,-|")).length){var o,i=[];n.forEach(function(e){(e=(e||"").replace(/ /g,"")).length&&(o?i.push(e):o=e)}),o&&(s.onNegotiationNeeded({newParticipant:e,userPreferences:t||!1},o),i.length&&setTimeout(function(){s.connectNewParticipantWithAllBroadcasters(e,t,i.join("|-,-|"))},3e3))}},this.onGettingRemoteMedia=function(e,t){},this.onRemovingRemoteMedia=function(e,t){},this.onGettingLocalMedia=function(e){},this.onLocalMediaError=function(e,t){r.onMediaError(e,t)},this.shareFile=function(e,n){if(!r.enableFileSharing)throw'"connection.enableFileSharing" is false.';i(),r.fbr.readAsArrayBuffer(e,function(t){var e=r.getAllParticipants();n&&(e=[n]),e.forEach(function(e){r.fbr.getNextChunk(t,function(t){r.peers[e].channels.forEach(function(e){e.send(t)})},e)})},{userid:r.userid,chunkSize:"Firefox"===DetectRTC.browser.name?15e3:r.chunkSize||0})};var n=new t(r);this.onDataChannelMessage=function(e,t){n.receive(JSON.parse(e),t,r.peers[t]?r.peers[t].extra:{})},this.onDataChannelClosed=function(e,t){e.userid=t,e.extra=r.peers[t]?r.peers[t].extra:{},r.onclose(e)},this.onDataChannelError=function(e,t){e.userid=t,event.extra=r.peers[t]?r.peers[t].extra:{},r.onerror(e)},this.onDataChannelOpened=function(e,t){r.peers[t].channels.length?r.peers[t].channels=[e]:(r.peers[t].channels.push(e),r.onopen({userid:t,extra:r.peers[t]?r.peers[t].extra:{},channel:e}))},this.onPeerStateChanged=function(e){r.onPeerStateChanged(e)},this.onNegotiationStarted=function(e,t){},this.onNegotiationCompleted=function(e,t){},this.getRemoteStreams=function(e){return e=e||r.peers.getAllParticipants()[0],r.peers[e]?r.peers[e].streams:[]},this.checkIfNextPossibleInitiator=function(e){r.sessionid!==e&&(r.autoCloseEntireSession||r.isInitiator&&1<r.getAllParticipants().length||r.socket.emit(r.socketMessageEvent,{remoteUserId:e,message:"next-possible-initiator",sender:r.userid}))}}function g(e,t,n){if("undefined"!=typeof CustomEvent){var o=new CustomEvent(t,{arguments:n,__exposedProps__:n});e.dispatchEvent(o)}}function v(t,n){n.stream&&n.stream&&n.stream.addEventListener&&(n.stream.addEventListener("mute",function(e){(e=t.streamEvents[n.streamid]).session={audio:"audio"===e.muteType,video:"video"===e.muteType},t.onmute(e)},!1),n.stream.addEventListener("unmute",function(e){(e=t.streamEvents[n.streamid]).session={audio:"audio"===e.unmuteType,video:"video"===e.unmuteType},t.onunmute(e)},!1))}function h(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),t="",n=0,o=e.length;n<o;n++)t+=e[n].toString(36);return t}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function w(n,t,o){if(o.autoCreateMediaElement){var e=!1;!n.getVideoTracks||n.getVideoTracks().length||n.isVideo||n.isScreen||(e=!0),"Firefox"===DetectRTC.browser.name&&(o.session.video||o.session.screen)&&(e=!1);var i=document.createElement(e?"audio":"video");i.srcObject=n;try{i.setAttributeNode(document.createAttribute("autoplay")),i.setAttributeNode(document.createAttribute("playsinline")),i.setAttributeNode(document.createAttribute("controls"))}catch(e){i.setAttribute("autoplay",!0),i.setAttribute("playsinline",!0),i.setAttribute("controls",!0)}if("Firefox"===DetectRTC.browser.name){var r="ended";"oninactive"in i&&(r="inactive"),i.addEventListener(r,function(){if(currentUserMediaRequest.remove(n.idInstance),"local"===n.type){r="ended","oninactive"in n&&(r="inactive"),A.onSyncNeeded(n.streamid,r),o.attachStreams.forEach(function(e,t){n.streamid===e.streamid&&delete o.attachStreams[t]});var t=[];o.attachStreams.forEach(function(e){e&&t.push(e)}),o.attachStreams=t;var e=o.streamEvents[n.streamid];if(e)return void o.onstreamended(e);this.parentNode&&this.parentNode.removeChild(this)}},!1)}var s=i.play();if(void 0!==s){var a=!1;setTimeout(function(){a||(a=!0,t(i))},1e3),s.then(function(){a||(a=!0,t(i))}).catch(function(e){a||(a=!0,t(i))})}else t(i)}else t({})}function S(e,t){window.removeEventListener(e,t),window.addEventListener(e,t,!1)}function c(e){var t=[];return e.forEach(function(e){e&&t.push(e)}),t}function C(e){return!e.audio&&!e.video&&!e.screen&&e.data}function u(e){return void 0===e}!function(){var e,t="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(w="object"==typeof process&&"object"==typeof process.versions&&process.versions.node&&!process.browser){var n=process.versions.node.toString().replace("v","");t="Nodejs/"+n+" (NodeOS) AppleWebKit/"+n+" (KHTML, like Gecko) Nodejs/"+n+" Nodejs/"+n}e="undefined"!=typeof global?global:window,"undefined"==typeof window&&("undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:t,getUserMedia:function(){}},e.window=global),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}));var a=window.navigator;void 0!==a?(void 0!==a.webkitGetUserMedia&&(a.getUserMedia=a.webkitGetUserMedia),void 0!==a.mozGetUserMedia&&(a.getUserMedia=a.mozGetUserMedia)):a={getUserMedia:function(){},userAgent:t};var o=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(a.userAgent||""),d=!(-1===a.userAgent.indexOf("Edge")||!a.msSaveOrOpenBlob&&!a.msSaveBlob),c=!!window.opera||0<=a.userAgent.indexOf(" OPR/"),u=void 0!==window.InstallTrigger,l=/^((?!chrome|android).)*safari/i.test(a.userAgent),m=!!window.chrome&&!c,f="undefined"!=typeof document&&!!document.documentMode&&!d;function i(e,t){var n=0,o=!1,i=window.setInterval(function(){e()&&(window.clearInterval(i),t(o)),50<n++&&(window.clearInterval(i),t(o=!0))},10)}var r={Android:function(){return a.userAgent.match(/Android/i)},BlackBerry:function(){return a.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return a.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return a.userAgent.match(/Opera Mini/i)},Windows:function(){return a.userAgent.match(/IEMobile/i)},any:function(){return r.Android()||r.BlackBerry()||r.iOS()||r.Opera()||r.Windows()},getOsName:function(){var e="Unknown OS";return r.Android()&&(e="Android"),r.BlackBerry()&&(e="BlackBerry"),r.iOS()&&(e="iOS"),r.Opera()&&(e="Opera Mini"),r.Windows()&&(e="Windows"),e}};var s="Unknown OS",p="Unknown OS Version";var v,g,h=function(){for(var e,t=a.appVersion,n=a.userAgent,o="-",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],r=0;e=i[r];r++)if(e.r.test(n)){o=e.s;break}var s="-";switch(/Windows/.test(o)&&(/Windows (.*)/.test(o)&&(s=/Windows (.*)/.exec(o)[1]),o="Windows"),o){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(s=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(s=(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+s[2]+"."+(0|s[3]))}return{osName:o,osVersion:s}}();h&&h.osName&&"-"!=h.osName?(s=h.osName,p=h.osVersion):r.any()&&"Android"==(s=r.getOsName())&&(p=!!(g=(v=(v||a.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&g[1]);var w="object"==typeof process&&"object"==typeof process.versions&&process.versions.node;"Unknown OS"===s&&w&&(s="Nodejs",p=process.versions.node.toString().replace("v",""));var S=!1,C=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!S&&e in document.createElement("canvas")&&(S=!0),!C&&e in document.createElement("video")&&(C=!0))});var b=[],y=[],k=[],T=[];a.mediaDevices&&a.mediaDevices.enumerateDevices&&(a.enumerateDevices=function(e){var t=a.mediaDevices.enumerateDevices();t&&t.then?a.mediaDevices.enumerateDevices().then(e).catch(function(){e([])}):e([])});var R=!1;void 0!==Y&&"getSources"in Y?R=!0:a.mediaDevices&&a.mediaDevices.enumerateDevices&&(R=!0);var x=!1,P=!1,M=!1,E=!1,O=!1;function D(t){if(R)if(!a.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(a.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!a.enumerateDevices&&a.enumerateDevices&&(a.enumerateDevices=a.enumerateDevices.bind(a)),a.enumerateDevices){b=[],y=[],k=[],O=E=M=P=x=!(T=[]);var o={};a.enumerateDevices(function(e){e.forEach(function(e){var t={};for(var n in e)try{"function"!=typeof e[n]&&(t[n]=e[n])}catch(e){}o[t.deviceId+t.label+t.kind]||("audio"===t.kind&&(t.kind="audioinput"),"video"===t.kind&&(t.kind="videoinput"),t.deviceId||(t.deviceId=t.id),t.id||(t.id=t.deviceId),t.label?("videoinput"!==t.kind||O||(O=!0),"audioinput"!==t.kind||E||(E=!0)):(t.isCustomLabel=!0,"videoinput"===t.kind?t.label="Camera "+(T.length+1):"audioinput"===t.kind?t.label="Microphone "+(y.length+1):"audiooutput"===t.kind?t.label="Speaker "+(k.length+1):t.label="Please invoke getUserMedia once.",void 0!==A&&A.browser.isChrome&&46<=A.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(t.label="HTTPs is required to get label of this "+t.kind+" device.")),"audioinput"===t.kind&&(x=!0,-1===y.indexOf(t)&&y.push(t)),"audiooutput"===t.kind&&(P=!0,-1===k.indexOf(t)&&k.push(t)),"videoinput"===t.kind&&(M=!0,-1===T.indexOf(t)&&T.push(t)),b.push(t),o[t.deviceId+t.label+t.kind]=t)}),void 0!==A&&(A.MediaDevices=b,A.hasMicrophone=x,A.hasSpeakers=P,A.hasWebcam=M,A.isWebsiteHasWebcamPermissions=O,A.isWebsiteHasMicrophonePermissions=E,A.audioInputDevices=y,A.audioOutputDevices=k,A.videoInputDevices=T),t&&t()})}else t&&t();else t&&t()}var A=window.DetectRTC||{};A.browser=function(){a.appVersion;var e,t,n,o=a.userAgent,i=a.appName,r=""+parseFloat(a.appVersion),s=parseInt(a.appVersion,10);if(c){i="Opera";try{s=(r=a.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){r="0.0.0.0",s=0}}else f?(0<(t=o.indexOf("rv:"))?r=o.substring(t+3):(t=o.indexOf("MSIE"),r=o.substring(t+5)),i="IE"):m?(t=o.indexOf("Chrome"),i="Chrome",r=o.substring(t+7)):l?(t=o.indexOf("Safari"),i="Safari",r=o.substring(t+7),-1!==(t=o.indexOf("Version"))&&(r=o.substring(t+8)),-1!==a.userAgent.indexOf("Version/")&&(r=a.userAgent.split("Version/")[1].split(" ")[0])):u?(t=o.indexOf("Firefox"),i="Firefox",r=o.substring(t+8)):(e=o.lastIndexOf(" ")+1)<(t=o.lastIndexOf("/"))&&(i=o.substring(e,t),r=o.substring(t+1),i.toLowerCase()===i.toUpperCase()&&(i=a.appName));return d&&(i="Edge",r=a.userAgent.split("Edge/")[1]),-1!==(n=r.search(/[; \)]/))&&(r=r.substring(0,n)),s=parseInt(""+r,10),isNaN(s)&&(r=""+parseFloat(a.appVersion),s=parseInt(a.appVersion,10)),{fullVersion:r,version:s,name:i,isPrivateBrowsing:!1}}(),function(t){var n;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){n=!1},function(e){n=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var o;try{(o=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){n=!0}void 0===n&&i(function(){return"done"===o.readyState},function(e){e||(n=!o.result)})}else if(function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var n=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(n&&10<=parseInt(n[1],10))}(window.navigator.userAgent)){n=!1;try{window.indexedDB||(n=!0)}catch(e){n=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){n=!0}void 0===n&&(n=!1,window.localStorage.removeItem("test"))}}catch(e){n=!1}i(function(){return void 0!==n},function(e){t(n)})}(function(e){A.browser.isPrivateBrowsing=!!e}),A.browser["is"+A.browser.name]=!0,A.osName=s,A.osVersion=p;"object"==typeof process&&"object"==typeof process.versions&&process.versions["node-webkit"];var L=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){L||e in window&&(L=!0)}),A.isWebRTCSupported=L,A.isORTCSupported="undefined"!=typeof RTCIceGatherer;var U=!1;(A.browser.isChrome&&35<=A.browser.version?U=!0:A.browser.isFirefox&&34<=A.browser.version?U=!0:A.browser.isEdge&&17<=A.browser.version?U=!0:"Android"===A.osName&&A.browser.isChrome&&(U=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(A.browser.isChrome||A.browser.isEdge||A.browser.isOpera)?U=!1:A.browser.isFirefox&&(U=!1));A.isScreenCapturingSupported=U;var I={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){I.isSupported||e in window&&(I.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(I.isCreateMediaStreamSourceSupported=!0))}),A.isAudioContextSupported=I.isSupported,A.isCreateMediaStreamSourceSupported=I.isCreateMediaStreamSourceSupported;var N=!1;A.browser.isChrome&&31<A.browser.version&&(N=!0),A.isRtpDataChannelsSupported=N;var W=!1;A.browser.isFirefox&&28<A.browser.version?W=!0:A.browser.isChrome&&25<A.browser.version?W=!0:A.browser.isOpera&&11<=A.browser.version&&(W=!0),A.isSctpDataChannelsSupported=W,A.isMobileDevice=o;var B=!1;a.getUserMedia?B=!0:a.mediaDevices&&a.mediaDevices.getUserMedia&&(B=!0),A.browser.isChrome&&46<=A.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(B="Requires HTTPs"),"Nodejs"===A.osName&&(B=!1),A.isGetUserMediaSupported=B;var V,F,q,G="";screen.width&&(G+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));A.displayResolution=G,A.displayAspectRatio=(V=screen.width,F=screen.height,q=function e(t,n){return 0==n?t:e(n,t%n)}(V,F),V/q/(F/q)).toFixed(2),A.isCanvasSupportsStreamCapturing=S,A.isVideoSupportsStreamCapturing=C,"Chrome"==A.browser.name&&53<=A.browser.version&&(A.isCanvasSupportsStreamCapturing||(A.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),A.isVideoSupportsStreamCapturing||(A.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),A.DetectLocalIPAddress=function(t,e){A.isWebRTCSupported&&function(o,e){if("undefined"!=typeof document&&"function"==typeof document.getElementById){var i={},t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!t){var n=document.getElementById("iframe");if(!n)return;var r=n.contentWindow;t=r.RTCPeerConnection||r.mozRTCPeerConnection||r.webkitRTCPeerConnection}if(t){var s=null;"Chrome"===A.browser&&A.browser.version<58&&(s={optional:[{RtpDataChannels:!0}]});var a=new t({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},s);if(e&&(a.addStream?a.addStream(e):a.addTrack&&e.getTracks()[0]&&a.addTrack(e.getTracks()[0],e)),a.onicecandidate=function(e){e.candidate&&d(e.candidate.candidate)},!e)try{a.createDataChannel("sctp",{})}catch(e){}A.isPromisesSupported?a.createOffer().then(function(e){a.setLocalDescription(e).then(c)}):a.createOffer(function(e){a.setLocalDescription(e,c,function(){})},function(){})}}function d(e){var t=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(e);if(t){var n=t[1];void 0===i[n]&&o(n),i[n]=!0}}function c(){var e=a.localDescription.sdp.split("\n");e.forEach(function(e){0===e.indexOf("a=candidate:")&&d(e)})}}(function(e){e.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/)?t("Local: "+e):t("Public: "+e)},e)},A.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,A.isWebSocketsBlocked=!A.isWebSocketsSupported,"Nodejs"===A.osName&&(A.isWebSocketsSupported=!0,A.isWebSocketsBlocked=!1),A.checkWebSocketsSupport=function(t){t=t||function(){};try{var e,n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){A.isWebSocketsBlocked=!1,e=(new Date).getTime(),n.send("ping")},n.onmessage=function(){A.WebsocketLatency=(new Date).getTime()-e+"ms",t(),n.close(),n=null},n.onerror=function(){A.isWebSocketsBlocked=!0,t()}}catch(e){A.isWebSocketsBlocked=!0,t()}},A.load=function(e){D(e=e||function(){})},A.MediaDevices=void 0!==b?b:[],A.hasMicrophone=x,A.hasSpeakers=P,A.hasWebcam=M,A.isWebsiteHasWebcamPermissions=O,A.isWebsiteHasMicrophonePermissions=E,A.audioInputDevices=y,A.audioOutputDevices=k,A.videoInputDevices=T;var j=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(j=!0),A.isSetSinkIdSupported=j;var H=!1;A.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(H=!0):A.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(H=!0),A.isRTPSenderReplaceTracksSupported=H;var z=!1;A.browser.isFirefox&&38<A.browser.version&&(z=!0),A.isRemoteStreamProcessingSupported=z;var X=!1;void 0!==Y&&"applyConstraints"in Y.prototype&&(X=!0),A.isApplyConstraintsSupported=X;var _=!1;A.browser.isFirefox&&43<=A.browser.version&&(_=!0),A.isMultiMonitorScreenCapturingSupported=_,A.isPromisesSupported=!!("Promise"in window),A.version="1.3.6",void 0===A&&(window.DetectRTC={});var J=window.MediaStream;void 0===J&&"undefined"!=typeof webkitMediaStream&&(J=webkitMediaStream),A.MediaStream=void 0!==J&&"function"==typeof J&&Object.keys(J.prototype),A.MediaStreamTrack=void 0!==Y&&Object.keys(Y.prototype);var K=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;A.RTCPeerConnection=void 0!==K&&Object.keys(K.prototype),window.DetectRTC=A,"undefined"!=typeof module&&(module.exports=A),"function"==typeof define&&define.amd&&define("DetectRTC",[],function(){return A})}(),"undefined"!=typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),window.addEventListener||(window.addEventListener=function(e,t,n){e.attachEvent&&e.attachEvent("on"+t,n)}),window.attachEventListener=function(e,t,n,o){e.addEventListener(t,n,o)};var b=window.MediaStream;function y(e,t){return(!e.session.audio||"two-way"!==e.session.audio)&&("Firefox"===DetectRTC.browser.name&&!1!==t||!("Chrome"!==DetectRTC.browser.name||DetectRTC.browser.version<50)&&(!0===typeof t||!(void 0!==t||!e.session.audio||!e.session.screen||e.session.video)&&(t=!0)))}function k(e){return"Firefox"===DetectRTC.browser.name||"Chrome"===DetectRTC.browser.name&&{mandatory:{chromeMediaSource:e.mandatory.chromeMediaSource,chromeMediaSourceId:e.mandatory.chromeMediaSourceId}}}function e(){if("undefined"!=typeof cordova&&void 0!==cordova.plugins&&void 0!==cordova.plugins.iosrtc){var e=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=e.RTCPeerConnection,window.RTCSessionDescription=e.RTCSessionDescription,window.RTCIceCandidate=e.RTCIceCandidate,window.MediaStream=e.MediaStream,window.MediaStreamTrack=e.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=e.getUserMedia,e.debug.enable("iosrtc*"),"function"==typeof e.selectAudioOutput&&e.selectAudioOutput(window.iOSDefaultAudioOutputDevice||"speaker"),e.registerGlobals()}}void 0===b&&"undefined"!=typeof webkitMediaStream&&(b=webkitMediaStream),void 0!==b&&("stop"in b.prototype||(b.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})})),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||"speaker",void 0===window.enableAdapter&&("Firefox"===DetectRTC.browser.name&&54<=DetectRTC.browser.version&&(window.enableAdapter=!0),"Chrome"===DetectRTC.browser.name&&DetectRTC.browser.version,"undefined"!=typeof adapter&&adapter.browserDetails&&"string"==typeof adapter.browserDetails.browser&&(window.enableAdapter=!0)),window.enableAdapter||(void 0===URL.createObjectURL&&(URL.createObjectURL=function(e){return"blob:https://"+document.domain+"/"+h()}),"srcObject"in HTMLMediaElement.prototype||(HTMLMediaElement.prototype.srcObject=function(e){"mozSrcObject"in this?this.mozSrcObject=e:this.src=URL.createObjectURL(e)})),document.addEventListener("deviceready",e,!1),e();var T,R={};function x(e){var t={OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo},n=!window.enableAdapter;return"Chrome"===DetectRTC.browser.name&&DetectRTC.browser.version,"Firefox"===DetectRTC.browser.name&&54<=DetectRTC.browser.version&&(n=!1),n&&(t={mandatory:t,optional:[{VoiceActivityDetection:!1}]}),t}void 0!==window.RTCPeerConnection?T=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?T=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(T=webkitRTCPeerConnection);var P=window.RTCSessionDescription||window.mozRTCSessionDescription,M=window.RTCIceCandidate||window.mozRTCIceCandidate,Y=window.MediaStreamTrack;function l(o){if(void 0!==window.RTCPeerConnection?T=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?T=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(T=webkitRTCPeerConnection),P=window.RTCSessionDescription||window.mozRTCSessionDescription,M=window.RTCIceCandidate||window.mozRTCIceCandidate,Y=window.MediaStreamTrack,!T)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var r=o.rtcMultiConnection;this.extra=o.remoteSdp?o.remoteSdp.extra:r.extra,this.userid=o.userid,this.streams=[],this.channels=o.channels||[],this.connectionDescription=o.connectionDescription,this.addStream=function(e){r.addStream(e,n.userid)},this.removeStream=function(e){r.removeStream(e,n.userid)};var n=this;o.remoteSdp&&(this.connectionDescription=o.remoteSdp.connectionDescription);var s,i={};R.sdpConstraints=x({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var e=!!o.renegotiatingPeer;o.remoteSdp&&(e=!!o.remoteSdp.renegotiatingPeer);var t=[];if(r.attachStreams.forEach(function(e){e&&t.push(e)}),e)s=o.peerRef;else{var a="all";(r.candidates.turn||r.candidates.relay)&&(r.candidates.stun||r.candidates.reflexive||r.candidates.host||(a="relay"));try{var d={};"Chrome"!==DetectRTC.browser.name&&(d.iceServers=r.iceServers),"Chrome"===DetectRTC.browser.name&&(d={iceServers:r.iceServers,iceTransportPolicy:r.iceTransportPolicy||a}),r.iceServers.length||(d=null,r.optionalArgument=null),s=new T(d,r.optionalArgument)}catch(e){try{d={iceServers:r.iceServers};s=new T(d)}catch(e){s=new T}}}!s.getRemoteStreams&&s.getReceivers&&(s.getRemoteStreams=function(){var t=new b;return s.getReceivers().forEach(function(e){t.addTrack(e.track)}),[t]}),!s.getLocalStreams&&s.getSenders&&(s.getLocalStreams=function(){var t=new b;return s.getSenders().forEach(function(e){t.addTrack(e.track)}),[t]}),s.onicecandidate=function(e){if(e.candidate)r.trickleIce&&o.onLocalCandidate({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else if(!r.trickleIce){var t=s.localDescription;o.onLocalSdp({type:t.type,sdp:t.sdp,remotePeerSdpConstraints:o.remotePeerSdpConstraints||!1,renegotiatingPeer:!!o.renegotiatingPeer||!1,connectionDescription:n.connectionDescription,dontGetRemoteStream:!!o.dontGetRemoteStream,extra:r?r.extra:{},streamsToShare:p})}},t.forEach(function(t){if(!(o.remoteSdp&&o.remoteSdp.remotePeerSdpConstraints&&o.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream)&&!o.dontAttachLocalStream&&(t=r.beforeAddingStream(t,n)))if(s.getLocalStreams().forEach(function(e){t&&e.id==t.id&&(t=null)}),t&&"function"==typeof s.addTrack)t.getTracks().forEach(function(e){try{s.addTrack(e,t)}catch(e){}});else if(t&&"function"==typeof s.addStream)s.addStream(t);else try{s.addStream(t)}catch(e){t&&t.getTracks().forEach(function(e){try{s.addTrack(e,t)}catch(e){}})}}),s.oniceconnectionstatechange=s.onsignalingstatechange=function(){var e=n.extra;r.peers[n.userid]&&(e=r.peers[n.userid].extra||e),s&&(o.onPeerStateChanged({iceConnectionState:s.iceConnectionState,iceGatheringState:s.iceGatheringState,signalingState:s.signalingState,extra:e,userid:n.userid}),s&&s.iceConnectionState&&-1!==s.iceConnectionState.search(/closed|failed/gi)&&n.streams instanceof Array&&n.streams.forEach(function(e){var t=r.streamEvents[e.id]||{streamid:e.id,stream:e,type:"remote"};r.onstreamended(t)}))};var c={OfferToReceiveAudio:!!t.length,OfferToReceiveVideo:!!t.length};o.localPeerSdpConstraints&&(c=o.localPeerSdpConstraints),R.sdpConstraints=x(c);var u={},l="track";window.enableAdapter||(l="addstream"),s.addEventListener(l,function(t){if(t&&("track"===l&&(t.stream=t.streams[t.streams.length-1]),!u[t.stream.id]||"Safari"===DetectRTC.browser.name)){u[t.stream.id]=t.stream.id;var e={};o.remoteSdp&&o.remoteSdp.streamsToShare?e=o.remoteSdp.streamsToShare:o.streamsToShare&&(e=o.streamsToShare);var n=e[t.stream.id];n?(t.stream.isAudio=n.isAudio,t.stream.isVideo=n.isVideo,t.stream.isScreen=n.isScreen):(t.stream.isVideo=!!t.stream.getVideoTracks().length,t.stream.isAudio=!t.stream.isVideo,t.stream.isScreen=!1),t.stream.streamid=t.stream.id,"Firefox"!=DetectRTC.browser.name&&t.stream.stop||(t.stream.stop=function(){var e="ended";"oninactive"in t.stream&&(e="inactive"),g(t.stream,e)}),i[t.stream.id]=t.stream,o.onRemoteStream(t.stream)}},!1),s.onremovestream=function(e){e.stream.streamid=e.stream.id,i[e.stream.id]&&delete i[e.stream.id],o.onRemoteStreamRemoved(e.stream)},this.addRemoteCandidate=function(e){s.addIceCandidate(new M(e))},this.addRemoteSdp=function(t,n){if(n=n||function(){},!window.enableAdapter)return o=t,i=(i=n)||function(){},"Safari"!==DetectRTC.browser.name&&(o.sdp=r.processSdp(o.sdp)),void s.setRemoteDescription(new P(o),i,function(e){r.enableLogs&&console.error("setRemoteDescription failed","\n",e,"\n",o.sdp),i()});var o,i;"Safari"!==DetectRTC.browser.name&&(t.sdp=r.processSdp(t.sdp)),s.setRemoteDescription(new P(t)).then(n,function(e){r.enableLogs&&console.error("setRemoteDescription failed","\n",e,"\n",t.sdp),n()})};var m=!0;function f(t){t.binaryType="arraybuffer",t.onmessage=function(e){o.onDataChannelMessage(e.data)},t.onopen=function(){o.onDataChannelOpened(t)},t.onerror=function(e){o.onDataChannelError(e)},t.onclose=function(e){o.onDataChannelClosed(e)},t.internalSend=t.send,t.send=function(e){"open"===t.readyState&&t.internalSend(e)},s.channel=t}o.remoteSdp&&(m=!1),this.createDataChannel=function(){f(s.createDataChannel("sctp",{}))},!0!==r.session.data||e||(m?this.createDataChannel():s.ondatachannel=function(e){f(e.channel)}),o.remoteSdp&&(o.remoteSdp.remotePeerSdpConstraints&&(c=o.remoteSdp.remotePeerSdpConstraints),R.sdpConstraints=x(c),this.addRemoteSdp(o.remoteSdp,function(){v("createAnswer")})),"two-way"!=r.session.audio&&"two-way"!=r.session.video&&"two-way"!=r.session.screen||(R.sdpConstraints=x({OfferToReceiveAudio:"two-way"==r.session.audio||o.remoteSdp&&o.remoteSdp.remotePeerSdpConstraints&&o.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==r.session.video||"two-way"==r.session.screen||o.remoteSdp&&o.remoteSdp.remotePeerSdpConstraints&&o.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var p={};function v(e){var t;window.enableAdapter?s[e](R.sdpConstraints).then(function(e){"Safari"!==DetectRTC.browser.name&&(e.sdp=r.processSdp(e.sdp)),s.setLocalDescription(e).then(function(){r.trickleIce&&(o.onLocalSdp({type:e.type,sdp:e.sdp,remotePeerSdpConstraints:o.remotePeerSdpConstraints||!1,renegotiatingPeer:!!o.renegotiatingPeer||!1,connectionDescription:n.connectionDescription,dontGetRemoteStream:!!o.dontGetRemoteStream,extra:r?r.extra:{},streamsToShare:p}),r.onSettingLocalDescription(n))},function(e){r.enableLogs&&console.error("setLocalDescription error",e)})},function(e){r.enableLogs&&console.error("sdp-error",e)}):s[t=e](function(e){"Safari"!==DetectRTC.browser.name&&(e.sdp=r.processSdp(e.sdp)),s.setLocalDescription(e,function(){r.trickleIce&&(o.onLocalSdp({type:e.type,sdp:e.sdp,remotePeerSdpConstraints:o.remotePeerSdpConstraints||!1,renegotiatingPeer:!!o.renegotiatingPeer||!1,connectionDescription:n.connectionDescription,dontGetRemoteStream:!!o.dontGetRemoteStream,extra:r?r.extra:{},streamsToShare:p}),r.onSettingLocalDescription(n))},function(e){r.enableLogs&&console.error("setLocalDescription-error",e)})},function(e){r.enableLogs&&console.error("sdp-"+t+"-error",e)},R.sdpConstraints)}s.getLocalStreams().forEach(function(e){p[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),m&&v("createOffer"),s.nativeClose=s.close,s.close=function(){if(s){try{s.nativeClose!==s.close&&s.nativeClose()}catch(e){}s=null,n.peer=null}},this.peer=s}var E=function(){function t(e,t){var n=i(e);return n.videoCodecNumbers?"vp8"===t&&n.vp8LineNumber===n.videoCodecNumbers[0]?e:"vp9"===t&&n.vp9LineNumber===n.videoCodecNumbers[0]?e:"h264"===t&&n.h264LineNumber===n.videoCodecNumbers[0]?e:e=o(e,t,n):e}function o(e,t,n,o){var i="";if("vp8"===t){if(!n.vp8LineNumber)return e;i=n.vp8LineNumber}if("vp9"===t){if(!n.vp9LineNumber)return e;i=n.vp9LineNumber}if("h264"===t){if(!n.h264LineNumber)return e;i=n.h264LineNumber}var r=n.videoCodecNumbersOriginal.split("SAVPF")[0]+"SAVPF ",s=[i];return o&&(s=[]),n.videoCodecNumbers.forEach(function(e){e!==i&&s.push(e)}),r+=s.join(" "),e=e.replace(n.videoCodecNumbersOriginal,r)}function i(e){var n={};return e.split("\n").forEach(function(t){0===t.indexOf("m=video")&&(n.videoCodecNumbers=[],t.split("SAVPF")[1].split(" ").forEach(function(e){(e=e.trim())&&e.length&&(n.videoCodecNumbers.push(e),n.videoCodecNumbersOriginal=t)})),-1===t.indexOf("VP8/90000")||n.vp8LineNumber||(n.vp8LineNumber=t.replace("a=rtpmap:","").split(" ")[0]),-1===t.indexOf("VP9/90000")||n.vp9LineNumber||(n.vp9LineNumber=t.replace("a=rtpmap:","").split(" ")[0]),-1===t.indexOf("H264/90000")||n.h264LineNumber||(n.h264LineNumber=t.replace("a=rtpmap:","").split(" ")[0])}),n}function l(e,t,n){return function(e,t,n,o,i){for(var r=-1!==n?n:e.length,s=t;s<r;++s)if(0===e[s].indexOf(o)&&(!i||-1!==e[s].toLowerCase().indexOf(i.toLowerCase())))return s;return null}(e,0,-1,t,n)}function m(e){var t=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),n=e.match(t);return n&&2===n.length?n[1]:null}return{removeVPX:function(e){var t=i(e);return e=o(e=o(e,"vp9",t,!0),"vp8",t,!0)},disableNACK:function(e){if(!e||"string"!=typeof e)throw"Invalid arguments.";return e=(e=(e=(e=e.replace("a=rtcp-fb:126 nack\r\n","")).replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n")).replace("a=rtcp-fb:97 nack\r\n","")).replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n")},prioritize:function(o,e){if(e&&e.getSenders&&e.getSenders().length){if(!o||"string"!=typeof o)throw"Invalid arguments.";e.getSenders().forEach(function(e){for(var t=e.getParameters(),n=0;n<t.codecs.length;n++)if(t.codecs[n].mimeType==o){t.codecs.unshift(t.codecs.splice(n,1));break}e.setParameters(t)})}},removeNonG722:function(e){return e.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")},setApplicationSpecificBandwidth:function(e,t,n){return o=e,r=n,(i=t)&&("undefined"!=typeof isFirefox&&isFirefox||(r&&(i.screen?i.screen<300&&console.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):console.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),i.screen&&r&&(o=(o=o.replace(/b=AS([^\r\n]+\r\n)/g,"")).replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+i.screen+"\r\n")),(i.audio||i.video)&&(o=o.replace(/b=AS([^\r\n]+\r\n)/g,"")),i.audio&&(o=o.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+i.audio+"\r\n")),i.screen?o=o.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+i.screen+"\r\n"):i.video&&(o=o.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+i.video+"\r\n")))),o;var o,i,r},setVideoBitrates:function(e,t){return function(e,t){var n,o=(t=t||{}).min,i=t.max,r=e.split("\r\n"),s=l(r,"a=rtpmap","VP8/90000");if(s&&(n=m(r[s])),!n)return e;var a,d=l(r,"a=rtpmap","rtx/90000");if(d&&(a=m(r[d])),!d)return e;var c=l(r,"a=fmtp:"+a.toString());if(null!==c){var u="\r\n";u+="a=fmtp:"+n+" x-google-min-bitrate="+(o||"228")+"; x-google-max-bitrate="+(i||"228"),r[c]=r[c].concat(u),e=r.join("\r\n")}return e}(e,t)},setOpusAttributes:function(e,t){return function(e,t){t=t||{};var n,o=e.split("\r\n"),i=l(o,"a=rtpmap","opus/48000");if(i&&(n=m(o[i])),!n)return e;var r=l(o,"a=fmtp:"+n.toString());if(null===r)return e;var s="";return s+="; stereo="+(void 0!==t.stereo?t.stereo:"1"),s+="; sprop-stereo="+(void 0!==t["sprop-stereo"]?t["sprop-stereo"]:"1"),void 0!==t.maxaveragebitrate&&(s+="; maxaveragebitrate="+(t.maxaveragebitrate||1048576)),void 0!==t.maxplaybackrate&&(s+="; maxplaybackrate="+(t.maxplaybackrate||1048576)),void 0!==t.cbr&&(s+="; cbr="+(void 0!==t.cbr?t.cbr:"1")),void 0!==t.useinbandfec&&(s+="; useinbandfec="+t.useinbandfec),void 0!==t.usedtx&&(s+="; usedtx="+t.usedtx),void 0!==t.maxptime&&(s+="\r\na=maxptime:"+t.maxptime),o[r]=o[r].concat(s),e=o.join("\r\n")}(e,t)},preferVP9:function(e){return t(e,"vp9")},preferCodec:t,forceStereoAudio:function(e){for(var t=e.split("\r\n"),n=null,o=0;o<t.length;o++)if(-1!==t[o].search("opus/48000")){var i=extractSdp(t[o],/:(\d+) opus\/48000/i);break}for(o=0;o<t.length;o++)if(-1!==t[o].search("a=fmtp")&&extractSdp(t[o],/a=fmtp:(\d+)/)===i){n=o;break}return null===n?e:(t[n]=t[n].concat("; stereo=1; sprop-stereo=1"),e=t.join("\r\n"))}}}();window.BandwidthHandler=E;var m={processCandidates:function(e,t){var n=t.candidate,o=e.candidates,i=o.stun,r=o.turn;if(u(o.reflexive)||(i=o.reflexive),u(o.relay)||(r=o.relay),(o.host||!n.match(/typ host/g))&&(r||!n.match(/typ relay/g))&&(i||!n.match(/typ srflx/g))){var s=e.iceProtocols;if((s.udp||!n.match(/ udp /g))&&(s.tcp||!n.match(/ tcp /g)))return e.enableLogs&&console.debug("Your candidate pairs:",n),{candidate:n,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex}}}},O={getIceServers:function(e){var t=[{urls:["stun:webrtcweb.com:7788","stun:webrtcweb.com:7788?transport=udp"],username:"muazkh",credential:"muazkh"},{urls:["turn:webrtcweb.com:7788","turn:webrtcweb.com:4455?transport=udp","turn:webrtcweb.com:8877?transport=udp","turn:webrtcweb.com:8877?transport=tcp"],username:"muazkh",credential:"muazkh"},{urls:["stun:stun.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}];return void 0!==window.InstallTrigger&&(t[0].urls=t[0].urls.pop(),t[1].urls=t[1].urls.pop()),t}};function D(r){if(!0!==currentUserMediaRequest.mutex){currentUserMediaRequest.mutex=!0;var s=JSON.stringify(r.localMediaConstraints);if(currentUserMediaRequest.streams[s])a(currentUserMediaRequest.streams[s].stream,!0);else{if(!!/BB10|BlackBerry/i.test(navigator.userAgent||"")||void 0===navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(r.localMediaConstraints,function(e){e.streamid=e.streamid||e.id||h(),e.idInstance=s,a(e)},function(e){r.onLocalMediaError(e,r.localMediaConstraints)});if(void 0===navigator.mediaDevices){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var t,n,o=function(){};navigator.mediaDevices={getUserMedia:function(e){return navigator.getUserMedia(e,function(e){e(i),t=i},function(e){o(e),n=e}),{then:function(e){if(!t)return e,{then:function(e){n?e(n):o=e}};e(t)}}}}}if(window.stream){var i=window.stream;i.streamid=i.streamid||i.id||h(),i.idInstance=s,a(i)}else navigator.mediaDevices.getUserMedia(r.localMediaConstraints).then(function(e){e.streamid=e.streamid||e.id||h(),e.idInstance=s,a(e)}).catch(function(e){r.onLocalMediaError(e,r.localMediaConstraints)})}}else currentUserMediaRequest.queueRequests.push(r);function a(e,t){var n,o;n=r.localMediaConstraints,o=e,n.mandatory&&n.mandatory.chromeMediaSource?o.isScreen=!0:n.mozMediaSource||n.mediaSource?o.isScreen=!0:n.video?o.isVideo=!0:n.audio&&(o.isAudio=!0);var i="ended";"oninactive"in e&&(i="inactive"),e.addEventListener(i,function(){delete currentUserMediaRequest.streams[s],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(r)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(r)],currentUserMediaRequest.queueRequests=c(currentUserMediaRequest.queueRequests))},!1),currentUserMediaRequest.streams[s]={stream:e},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&D(currentUserMediaRequest.queueRequests.shift()),r.onGettingLocalMedia(e,t)}}window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(e){this.mutex=!1;var t=this.streams[e];if(t){var n=(t=t.stream).currentUserMediaRequestOptions;this.queueRequests.indexOf(n)&&(delete this.queueRequests[this.queueRequests.indexOf(n)],this.queueRequests=c(this.queueRequests)),this.streams[e].stream=null,delete this.streams[e]}}};var A=function(){function r(e){if(e)return"string"==typeof e||void 0===e?e:e.audio&&e.video?null:e.audio?"audio":e.video?"video":void 0}return{setHandlers:function(n,o,i){if(n&&n.addEventListener){if(void 0===o||1==o){var e="ended";"oninactive"in n&&(e="inactive"),n.addEventListener(e,function(){A.onSyncNeeded(this.streamid,e)},!1)}n.mute=function(e,t){e=r(e),void 0!==t&&(o=t),void 0!==e&&"audio"!=e||n.getAudioTracks().forEach(function(e){e.enabled=!1,i.streamEvents[n.streamid].isAudioMuted=!0}),void 0!==e&&"video"!=e||n.getVideoTracks().forEach(function(e){e.enabled=!1}),void 0!==o&&1!=o||A.onSyncNeeded(n.streamid,"mute",e),i.streamEvents[n.streamid].muteType=e||"both",g(n,"mute",e)},n.unmute=function(e,t){e=r(e),void 0!==t&&(o=t),function(){if(i.streamEvents[n.streamid].mediaElement){var t=i.streamEvents[n.streamid].mediaElement;t.volume=0,function e(t,n,o,i){n<=(i=(i||0)+1)||setTimeout(function(){o(),e(t,n,o,i)},t)}(200,5,function(){try{t.volume+=.2}catch(e){t.volume=1}})}}(),void 0!==e&&"audio"!=e||n.getAudioTracks().forEach(function(e){e.enabled=!0,i.streamEvents[n.streamid].isAudioMuted=!1}),void 0!==e&&"video"!=e||(n.getVideoTracks().forEach(function(e){e.enabled=!0}),void 0!==e&&"video"==e&&i.streamEvents[n.streamid].isAudioMuted&&function e(t){t||(t=0),++t<100&&i.streamEvents[n.streamid].isAudioMuted&&(n.mute("audio"),setTimeout(function(){e(t)},50))}()),void 0!==o&&1!=o||A.onSyncNeeded(n.streamid,"unmute",e),i.streamEvents[n.streamid].unmuteType=e||"both",g(n,"unmute",e)}}},onSyncNeeded:function(e,t,n){}}}();window.addEventListener("message",function(e){e.origin==window.location.origin&&function(e){if("PermissionDeniedError"==e){if(r="PermissionDeniedError",i)return i("PermissionDeniedError");throw new Error("PermissionDeniedError: User rejected to share his screen.")}"rtcmulticonnection-extension-loaded"==e&&(r="desktop");e.sourceId&&i&&(L=e.sourceId,i(L))}(e.data)}),window.IsAndroidChrome=!1;try{-1<navigator.userAgent.toLowerCase().indexOf("android")&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)&&(window.IsAndroidChrome=!0)}catch(e){}var L,i,r="screen";function U(e){if(e)return"Firefox"===DetectRTC.browser.name?I(e):window.IsAndroidChrome?(r="screen",void e(!0)):void("desktop"!=r?(window.postMessage("are-you-there","*"),setTimeout(function(){e("screen"!=r)},2e3)):e(!0))}function I(o){if(o){if("Firefox"!==DetectRTC.browser.name)return U(o);var i=!1;window.addEventListener("message",function e(t){var n=t.data;n&&void 0!==n.isScreenCapturingEnabled&&((i=!0)===n.isScreenCapturingEnabled?o(!0):o(!1),window.removeEventListener("message",e,!1))},!1),window.postMessage({checkIfScreenCapturingEnabled:!0,domains:[document.domain]},"*"),setTimeout(function(){i||o(!0)},2e3)}}function N(e,t){if(window.IsAndroidChrome)return r="screen",void t("installed-enabled");if(2!=arguments.length&&(t=e,e=window.RMCExtensionID||"ajhifddimkapgcifgcodmmfdlknahffk"),"Firefox"===DetectRTC.browser.name)return t("not-chrome");L=null,r="screen";var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){window.postMessage("are-you-there","*"),setTimeout(function(){t("screen"==r?"installed-disabled":"installed-enabled")},2e3)},n.onerror=function(){t("not-installed")}}function s(e,t){var n=function e(t,n){return 0==n?t:e(n,t%n)}(e,t);return e/n/(t/n)}function W(n,o){if("Firefox"===DetectRTC.browser.name)return n(null,{mozMediaSource:"window",mediaSource:"window"});L=null,U(function(e){var t={mandatory:{chromeMediaSource:r,maxWidth:screen.width,maxHeight:screen.height,minWidth:screen.width,minHeight:screen.height,minAspectRatio:s(screen.width,screen.height),maxAspectRatio:s(screen.width,screen.height),minFrameRate:64,maxFrameRate:128},optional:[]};window.IsAndroidChrome?n(null,t):"desktop"!=r||L?("desktop"==r&&(t.mandatory.chromeMediaSourceId=L),n(i=L=null,t)):function(e,t){if(!e)throw'"callback" parameter is mandatory.';L=null,i=e,t?window.postMessage("audio-plus-tab","*"):window.postMessage("get-sourceId","*")}(function(){t.mandatory.chromeMediaSourceId=L,n("PermissionDeniedError"==L?L:null,t),L=null},o)})}function t(s){var a={};return{receive:function(e,t,n){var o=e.uuid;if(a[o]||(a[o]=[]),a[o].push(e.message),e.last){var i=a[o].join("");e.isobject&&(i=JSON.parse(i));var r={data:i,userid:t,extra:n,latency:(new Date).getTime()-e.sendingTime};s.autoTranslateText?(r.original=r.data,s.Translator.TranslateText(r.data,function(e){r.data=e,s.onmessage(r)})):s.onmessage(r),delete a[o]}}}}var B={send:function(e){var i=e.connection,r=e.channel,s=e.remoteUserId,t=e.text,a=i.chunkSize||1e3,d="",c=!1;"string"!=typeof t&&(c=!0,t=JSON.stringify(t));var u=h(),l=(new Date).getTime();!function e(t,n){var o={type:"text",uuid:u,sendingTime:l};t&&(n=t,o.packets=parseInt(n.length/a));n.length>a?o.message=n.slice(0,a):(o.message=n,o.last=!0,o.isobject=c);r.send(o,s);d=n.slice(o.message.length);d.length&&setTimeout(function(){e(null,d)},i.chunkInterval||100)}(t)}},V={handle:function(n){var o={};n.onFileStart=function(e){var t=document.createElement("div");if(t.title=e.name,t.innerHTML="<label>0%</label> <progress></progress>",e.remoteUserId&&(t.innerHTML+=" (Sharing with:"+e.remoteUserId+")"),n.filesContainer||(n.filesContainer=document.body||document.documentElement),n.filesContainer.insertBefore(t,n.filesContainer.firstChild),!e.remoteUserId)return o[e.uuid]={div:t,progress:t.querySelector("progress"),label:t.querySelector("label")},void(o[e.uuid].progress.max=e.maxChunks);o[e.uuid]||(o[e.uuid]={}),o[e.uuid][e.remoteUserId]={div:t,progress:t.querySelector("progress"),label:t.querySelector("label")},o[e.uuid][e.remoteUserId].progress.max=e.maxChunks},n.onFileProgress=function(e){var t=o[e.uuid];t&&(e.remoteUserId&&!(t=o[e.uuid][e.remoteUserId])||(t.progress.value=e.currentPosition||e.maxChunks||t.progress.max,function(e,t){if(-1!==e.position){var n=+e.position.toFixed(2).split(".")[1]||100;t.innerHTML=n+"%"}}(t.progress,t.label)))},n.onFileEnd=function(e){var t=o[e.uuid];if(t){if(!e.remoteUserId||(t=o[e.uuid][e.remoteUserId])){var n=t.div;-1!=e.type.indexOf("image")?n.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><img src="'+e.url+'" title="'+e.name+'" style="max-width: 80%;">':n.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><iframe src="'+e.url+'" title="'+e.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'}}else console.error("No such progress-helper element exist.",e)}}},F={handle:function(s){s.autoTranslateText=!1,s.language="en",s.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",s.Translator={TranslateText:function(e,t){var n=document.createElement("script");n.type="text/javascript";var o=encodeURIComponent(e),i="method"+s.token();window[i]=function(e){e.data&&e.data.translations[0]&&t?t(e.data.translations[0].translatedText):e.error&&"Daily Limit Exceeded"===e.error.message?console.error('Text translation failed. Error message: "Daily Limit Exceeded."'):e.error?console.error(e.error.message):console.error(e)};var r="https://www.googleapis.com/language/translate/v2?key="+s.googKey+"&target="+(s.language||"en-US")+"&callback=window."+i+"&q="+o;n.src=r,document.getElementsByTagName("head")[0].appendChild(n)},getListOfLanguages:function(t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==XMLHttpRequest.DONE){var e=JSON.parse(n.responseText);if(e&&e.data&&e.data.languages)return void t(e.data.languages);if(e.error&&"Daily Limit Exceeded"===e.error.message)return void console.error('Text translation failed. Error message: "Daily Limit Exceeded."');if(e.error)return void console.error(e.error.message);console.error(e)}};var e="https://www.googleapis.com/language/translate/v2/languages?key="+s.googKey+"&target=en";n.open("GET",e,!0),n.send(null)}}}};!function(u){d=d||{useDefaultDevices:!0},u.channel=u.sessionid=(a||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var l=new p(u),e={};function c(t){if(u.socketAutoReConnect=!0,u.socket)t&&t(u.socket);else{if(void 0===f)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"==typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new f(u,function(e){t&&t(u.socket)})}}function m(e,n){if(u.dontCaptureUserMedia||e.isDataOnly)n();else{var t={};e.localPeerSdpConstraints.OfferToReceiveAudio&&(t.audio=u.mediaConstraints.audio),e.localPeerSdpConstraints.OfferToReceiveVideo&&(t.video=u.mediaConstraints.video);var o=e.session||u.session;o.oneway&&"two-way"!==o.audio&&"two-way"!==o.video&&"two-way"!==o.screen?n():(o.oneway&&o.audio&&"two-way"===o.audio&&(o={audio:!0}),(o.audio||o.video||o.screen)&&(o.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:y(u)}).then(function(e){e.isScreen=!0,l.onGettingLocalMedia(e),!o.audio&&!o.video||y(u)?n(e):u.invokeGetUserMedia(null,n)},function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):u.getScreenConstraints(function(e,t){u.invokeGetUserMedia({audio:!!y(u)&&k(t),video:t,isScreen:!0},!o.audio&&!o.video||y(u)?n:u.invokeGetUserMedia(null,n))}):(o.audio||o.video)&&u.invokeGetUserMedia(null,n,o)))}}function t(e,t){u.closeBeforeUnload&&(!0===u.isInitiator&&u.dontMakeMeModerator(),u.peers.getAllParticipants().forEach(function(e){l.onNegotiationNeeded({userLeft:!0},e),u.peers[e]&&u.peers[e].peer&&u.peers[e].peer.close(),delete u.peers[e]}),t||u.closeSocket(),u.broadcasters=[],u.isInitiator=!1)}function o(e,t){e?(t.audio&&e.getAudioTracks().forEach(function(e){e.applyConstraints(t.audio)}),t.video&&e.getVideoTracks().forEach(function(e){e.applyConstraints(t.video)})):u.enableLogs&&console.error("No stream to applyConstraints.")}function r(t,e,n){e?l.replaceTrack(t,e,n):u.peers.getAllParticipants().forEach(function(e){l.replaceTrack(t,e,n)})}function i(){if(u.isInitiator&&!u.session.oneway&&!u.session.broadcast&&"many-to-many"===u.direction){var t=u.broadcasters[0],n=[];u.broadcasters.forEach(function(e){e!==t&&n.push(e)}),u.autoCloseEntireSession||u.shiftModerationControl(t,n,!0)}}l.onGettingLocalMedia=function(t,n){if(n=n||function(){},!e[t.streamid]){e[t.streamid]=!0;try{t.type="local"}catch(e){}u.setStreamEndHandler(t),w(t,function(e){e.id=t.streamid,e.muted=!0,e.volume=0,-1===u.attachStreams.indexOf(t)&&u.attachStreams.push(t),void 0!==A&&A.setHandlers(t,!0,u),u.streamEvents[t.streamid]={stream:t,type:"local",mediaElement:e,userid:u.userid,extra:u.extra,streamid:t.streamid,isAudioMuted:!0},function(n,o){if(o.stream&&o.stream.getAudioTracks&&o.stream.getAudioTracks().length){if(!n||!o)throw"Both arguments are required.";if(n.onspeaking&&n.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(o.stream,{onspeaking:function(){n.onspeaking(o)},onsilence:function(){n.onsilence(o)},onvolumechange:function(e,t){n.onvolumechange&&n.onvolumechange(merge({volume:e,threshold:t},o))}})}}}(u,u.streamEvents[t.streamid]),v(u,u.streamEvents[t.streamid]),u.onstream(u.streamEvents[t.streamid]),n()},u)}},l.onGettingRemoteMedia=function(t,n){try{t.type="remote"}catch(e){}u.setStreamEndHandler(t,"remote-stream"),w(t,function(e){e.id=t.streamid,void 0!==A&&A.setHandlers(t,!1,u),u.streamEvents[t.streamid]={stream:t,type:"remote",userid:n,extra:u.peers[n]?u.peers[n].extra:{},mediaElement:e,streamid:t.streamid},v(u,u.streamEvents[t.streamid]),u.onstream(u.streamEvents[t.streamid])},u)},l.onRemovingRemoteMedia=function(e,t){var n=u.streamEvents[e.streamid];n||(n={stream:e,type:"remote",userid:t,extra:u.peers[t]?u.peers[t].extra:{},streamid:e.streamid,mediaElement:u.streamEvents[e.streamid]?u.streamEvents[e.streamid].mediaElement:null}),u.peersBackup[n.userid]&&(n.extra=u.peersBackup[n.userid].extra),u.onstreamended(n),delete u.streamEvents[e.streamid]},l.onNegotiationNeeded=function(e,t,n){t=t||e.remoteUserId,c(function(){u.socket.emit(u.socketMessageEvent,"password"in e?e:{remoteUserId:t,message:e,sender:u.userid},n||function(){})})},l.onUserLeft=function(e){u.deletePeer(e)},l.disconnectWith=function(e,t){u.socket&&u.socket.emit("disconnect-with",e,t||function(){}),u.deletePeer(e)},u.broadcasters=[],u.socketOptions={transport:"polling"},u.openOrJoin=function(a,d,c){c=c||function(){},u.checkPresence(a,function(e,t){if("function"==typeof d&&void 0!==d&&(c=d,d=null),!d&&u.password&&(d=u.password),e){u.sessionid=t;var n,o,i=!!u.session.oneway,r=C(u.session);o={OfferToReceiveAudio:u.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:u.sdpConstraints.mandatory.OfferToReceiveVideo},n={OfferToReceiveAudio:i?!!u.session.audio:u.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i?!!u.session.video||!!u.session.screen:u.sdpConstraints.mandatory.OfferToReceiveVideo};var s={remoteUserId:u.sessionid,message:{newParticipationRequest:!0,isOneWay:i,isDataOnly:r,localPeerSdpConstraints:n,remotePeerSdpConstraints:o},sender:u.userid,password:d||!1};m(s.message,function(){l.onNegotiationNeeded(s),c(e,t)})}else{u.waitingForLocalMedia=!0,u.isInitiator=!0;u.userid;u.userid=u.sessionid=a||u.sessionid,u.userid+="",u.socket.emit("changed-uuid",u.userid),d&&u.socket.emit("set-password",d),C(u.session)?u.waitingForLocalMedia=!1:u.captureUserMedia(function(){u.waitingForLocalMedia=!1,c(e,t)})}})},u.waitingForLocalMedia=!1,u.open=function(e,t,n){u.waitingForLocalMedia=!0,u.isInitiator=!0,n=n||function(){},"function"==typeof t&&(n=t,t=!1);u.userid;u.userid=u.sessionid=e||u.sessionid,u.userid+="",c(function(){if(u.socket.emit("changed-uuid",u.userid),u.password&&u.socket.emit("set-password",u.password),1==t&&u.becomePublicModerator(),C(u.session))return u.waitingForLocalMedia=!1,void n();u.captureUserMedia(function(){u.waitingForLocalMedia=!1,n()})})},u.becomePublicModerator=function(){u.isInitiator&&u.socket.emit("become-a-public-moderator")},u.dontMakeMeModerator=function(){u.socket.emit("dont-make-me-moderator")},u.deletePeer=function(t){if(t){var e={userid:t,extra:u.peers[t]?u.peers[t].extra:{}};if(u.peersBackup[e.userid]&&(e.extra=u.peersBackup[e.userid].extra),u.onleave(e),u.peers[t]){u.peers[t].streams.forEach(function(e){e.stop()});var n=u.peers[t].peer;if(n&&"closed"!==n.iceConnectionState)try{n.close()}catch(e){}u.peers[t]&&(u.peers[t].peer=null,delete u.peers[t])}if(-1!==u.broadcasters.indexOf(t)){var o=[];u.broadcasters.forEach(function(e){e!==t&&o.push(e)}),u.broadcasters=o,i()}}},u.rejoin=function(e){if(!u.isInitiator&&e&&Object.keys(e).length){var t={};u.peers[e.remoteUserId]&&(t=u.peers[e.remoteUserId].extra,u.deletePeer(e.remoteUserId)),e&&e.remoteUserId&&(u.join(e.remoteUserId),u.onReConnecting({userid:e.remoteUserId,extra:t}))}},u.join=u.connect=function(e,t){u.sessionid=!!e&&(e.sessionid||e.remoteUserId||e)||u.sessionid,u.sessionid+="";var n=!1,o=!1,i=!1,r=!1;if(e&&e.session||!e||"string"==typeof e){var s=e&&e.session||u.session;i=!!s.oneway,r=C(s),o={OfferToReceiveAudio:u.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:u.sdpConstraints.mandatory.OfferToReceiveVideo},n={OfferToReceiveAudio:i?!!u.session.audio:u.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i?!!u.session.video||!!u.session.screen:u.sdpConstraints.mandatory.OfferToReceiveVideo}}var a=function(){};"function"==typeof(t=t||{})&&(a=t,t={}),void 0!==t.localPeerSdpConstraints&&(n=t.localPeerSdpConstraints),void 0!==t.remotePeerSdpConstraints&&(o=t.remotePeerSdpConstraints),void 0!==t.isOneWay&&(i=t.isOneWay),void 0!==t.isDataOnly&&(r=t.isDataOnly);var d={remoteUserId:u.sessionid,message:{newParticipationRequest:!0,isOneWay:i,isDataOnly:r,localPeerSdpConstraints:n,remotePeerSdpConstraints:o},sender:u.userid,password:u.password||!1};return m(d.message,function(){c(function(){u.peers[u.sessionid]||(l.onNegotiationNeeded(d),a())})}),d},u.connectWithAllParticipants=function(e){l.onNegotiationNeeded("connectWithAllParticipants",e||u.sessionid)},u.removeFromBroadcastersList=function(e){l.onNegotiationNeeded("removeFromBroadcastersList",e||u.sessionid),u.peers.getAllParticipants(e||u.sessionid).forEach(function(e){l.onNegotiationNeeded("dropPeerConnection",e),u.deletePeer(e)}),u.attachStreams.forEach(function(e){e.stop()})},u.getUserMedia=u.captureUserMedia=function(o,i){o=o||function(){};var r=i||u.session;u.dontCaptureUserMedia||C(r)?o():(r.audio||r.video||r.screen)&&(r.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:y(u)}).then(function(e){if(e.isScreen=!0,l.onGettingLocalMedia(e),!r.audio&&!r.video||y(u))o(e);else{var t={};for(var n in r)"screen"!==n&&(t[n]=r[n]);u.invokeGetUserMedia(i,o,t)}},function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):u.getScreenConstraints(function(e,t){if(e)throw e;u.invokeGetUserMedia({audio:!!y(u)&&k(t),video:t,isScreen:!0},function(e){if(!r.audio&&!r.video||y(u))o(e);else{var t={};for(var n in r)"screen"!==n&&(t[n]=r[n]);u.invokeGetUserMedia(i,o,t)}})}):(r.audio||r.video)&&u.invokeGetUserMedia(i,o,r))},u.closeBeforeUnload=!0,window.addEventListener("beforeunload",t,!1),u.userid=h(),u.changeUserId=function(e,t){t=t||function(){},u.userid=e||h(),u.socket.emit("changed-uuid",u.userid,t)},u.extra={},u.attachStreams=[],u.session={audio:!0,video:!0},u.enableFileSharing=!1,u.bandwidth={screen:!1,audio:!1,video:!1},u.codecs={audio:"opus",video:"VP9"},u.processSdp=function(e){return"Safari"===DetectRTC.browser.name?e:("VP8"===u.codecs.video.toUpperCase()&&(e=E.preferCodec(e,"vp8")),"VP9"===u.codecs.video.toUpperCase()&&(e=E.preferCodec(e,"vp9")),"H264"===u.codecs.video.toUpperCase()&&(e=E.preferCodec(e,"h264")),"G722"===u.codecs.audio&&(e=E.removeNonG722(e)),"Firefox"===DetectRTC.browser.name||((u.bandwidth.video||u.bandwidth.screen)&&(e=E.setApplicationSpecificBandwidth(e,u.bandwidth,!!u.session.screen)),u.bandwidth.video&&(e=E.setVideoBitrates(e,{min:8*u.bandwidth.video*1024,max:8*u.bandwidth.video*1024})),u.bandwidth.audio&&(e=E.setOpusAttributes(e,{maxaveragebitrate:8*u.bandwidth.audio*1024,maxplaybackrate:8*u.bandwidth.audio*1024,stereo:1,maxptime:3}))),e)},void 0!==E&&(u.BandwidthHandler=u.CodecsHandler=E),u.mediaConstraints={audio:{mandatory:{},optional:u.bandwidth.audio?[{bandwidth:8*u.bandwidth.audio*1024||1048576}]:[]},video:{mandatory:{},optional:u.bandwidth.video?[{bandwidth:8*u.bandwidth.video*1024||1048576},{facingMode:"user"}]:[{facingMode:"user"}]}},"Firefox"===DetectRTC.browser.name&&(u.mediaConstraints={audio:!0,video:!0}),d.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load(function(){var t,n;if(DetectRTC.MediaDevices.forEach(function(e){"audioinput"===e.kind&&!1!==u.mediaConstraints.audio&&(t=e),"videoinput"===e.kind&&!1!==u.mediaConstraints.video&&(n=e)}),t){if("Firefox"===DetectRTC.browser.name)return void(!0!==u.mediaConstraints.audio?u.mediaConstraints.audio.deviceId=t.id:u.mediaConstraints.audio={deviceId:t.id});1==u.mediaConstraints.audio&&(u.mediaConstraints.audio={mandatory:{},optional:[]}),u.mediaConstraints.audio.optional||(u.mediaConstraints.audio.optional=[]);var e=[{sourceId:t.id}];u.mediaConstraints.audio.optional=e.concat(u.mediaConstraints.audio.optional)}if(n){if("Firefox"===DetectRTC.browser.name)return void(!0!==u.mediaConstraints.video?u.mediaConstraints.video.deviceId=n.id:u.mediaConstraints.video={deviceId:n.id});1==u.mediaConstraints.video&&(u.mediaConstraints.video={mandatory:{},optional:[]}),u.mediaConstraints.video.optional||(u.mediaConstraints.video.optional=[]);e=[{sourceId:n.id}];u.mediaConstraints.video.optional=e.concat(u.mediaConstraints.video.optional)}}),u.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},u.rtcpMuxPolicy="require",u.iceTransportPolicy=null,u.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},u.iceServers=O.getIceServers(u),u.candidates={host:!0,stun:!0,turn:!0},u.iceProtocols={tcp:!0,udp:!0},u.onopen=function(e){u.enableLogs&&console.info("Data connection has been opened between you & ",e.userid)},u.onclose=function(e){u.enableLogs&&console.warn("Data connection has been closed between you & ",e.userid)},u.onerror=function(e){u.enableLogs&&console.error(e.userid,"data-error",e)},u.onmessage=function(e){u.enableLogs&&console.debug("data-message",e.userid,e.data)},u.send=function(e,t){u.peers.send(e,t)},u.close=u.disconnect=u.leave=function(){t(0,!0)},u.closeEntireSession=function(t){t=t||function(){},u.socket.emit("close-entire-session",function e(){u.getAllParticipants().length?setTimeout(e,100):(u.onEntireSessionClosed({sessionid:u.sessionid,userid:u.userid,extra:u.extra}),u.changeUserId(null,function(){u.close(),t()}))})},u.onEntireSessionClosed=function(e){u.enableLogs&&console.info("Entire session is closed: ",e.sessionid,e.extra)},u.onstream=function(e){var t=u.videosContainer;t.insertBefore(e.mediaElement,t.firstChild);var n=e.mediaElement.play();void 0===n?setTimeout(function(){e.mediaElement.play()},2e3):n.catch(function(){}).then(function(){setTimeout(function(){e.mediaElement.play()},2e3)})},u.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},u.direction="many-to-many",u.removeStream=function(t,n){var o;u.attachStreams.forEach(function(e){e.id===t&&(o=e)}),o?(u.peers.getAllParticipants().forEach(function(e){if(!n||e===n){var t=u.peers[e];try{t.peer.removeStream(o)}catch(e){}}}),u.renegotiate()):console.warn("No such stream exist.",t)},u.addStream=function(n,t){if(n.getAudioTracks)return-1===u.attachStreams.indexOf(n)&&(n.streamid||(n.streamid=n.id),u.attachStreams.push(n)),void u.renegotiate(t);function o(e){n.streamCallback&&n.streamCallback(e),u.renegotiate(t)}C(n)?u.renegotiate(t):(n.audio||n.video||n.screen)&&(n.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:y(u)}).then(function(e){e.isScreen=!0,l.onGettingLocalMedia(e),!n.audio&&!n.video||y(u)?o(e):u.invokeGetUserMedia(null,function(e){o(e)})},function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):u.getScreenConstraints(function(e,t){if(e)return"PermissionDeniedError"===e?(n.streamCallback&&n.streamCallback(null),void(u.enableLogs&&console.error("User rejected to share his screen."))):alert(e);u.invokeGetUserMedia({audio:!!y(u)&&k(t),video:t,isScreen:!0},function(e){!n.audio&&!n.video||y(u)?o(e):u.invokeGetUserMedia(null,function(e){o(e)})})}):(n.audio||n.video)&&u.invokeGetUserMedia(null,o))},u.invokeGetUserMedia=function(n,o,e){e||(e=u.session),n||(n=u.mediaConstraints),D({onGettingLocalMedia:function(e){var t=n.video;t&&(t.mediaSource||t.mozMediaSource?e.isScreen=!0:t.mandatory&&t.mandatory.chromeMediaSource&&(e.isScreen=!0)),e.isScreen||(e.isVideo=e.getVideoTracks().length,e.isAudio=!e.isVideo&&e.getAudioTracks().length),l.onGettingLocalMedia(e,function(){"function"==typeof o&&o(e)})},onLocalMediaError:function(e,t){l.onLocalMediaError(e,t)},localMediaConstraints:n||{audio:!!e.audio&&n.audio,video:!!e.video&&n.video}})},u.applyConstraints=function(t,e){if(Y&&Y.prototype.applyConstraints){var n;if(e)return u.streamEvents[e]&&(n=u.streamEvents[e].stream),void o(n,t);u.attachStreams.forEach(function(e){o(e,t)})}else alert("track.applyConstraints is NOT supported in your browser.")},u.replaceTrack=function(n,t,o){if(n=n||{},T.prototype.getSenders)if(n instanceof Y)r(n,t,o);else{if(n instanceof b)return n.getVideoTracks().length&&r(n.getVideoTracks()[0],t,!0),void(n.getAudioTracks().length&&r(n.getAudioTracks()[0],t,!1));if(C(n))throw"connection.replaceTrack requires audio and/or video and/or screen.";(n.audio||n.video||n.screen)&&(n.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:y(u)}).then(function(e){e.isScreen=!0,l.onGettingLocalMedia(e),!n.audio&&!n.video||y(u)?i(e):u.invokeGetUserMedia(null,i)},function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):u.getScreenConstraints(function(e,t){if(e)return alert(e);u.invokeGetUserMedia({audio:!!y(u)&&k(t),video:t,isScreen:!0},!n.audio&&!n.video||y(u)?i:u.invokeGetUserMedia(null,i))}):(n.audio||n.video)&&u.invokeGetUserMedia(null,i))}else u.addStream(n);function i(e){u.replaceTrack(e,t,o||n.video||n.screen)}},u.resetTrack=function(e,n){e||(e=u.getAllParticipants()),"string"==typeof e&&(e=[e]),e.forEach(function(e){var t=u.peers[e].peer;void 0!==n&&!0!==n||!t.lastVideoTrack||u.replaceTrack(t.lastVideoTrack,e,!0),void 0!==n&&!1!==n||!t.lastAudioTrack||u.replaceTrack(t.lastAudioTrack,e,!1)})},u.renegotiate=function(e){e?l.renegotiatePeer(e):u.peers.getAllParticipants().forEach(function(e){l.renegotiatePeer(e)})},u.setStreamEndHandler=function(o,i){if(o&&o.addEventListener&&(i=!!i,!o.alreadySetEndHandler)){o.alreadySetEndHandler=!0;var e="ended";"oninactive"in o&&(e="inactive"),o.addEventListener(e,function(){if(o.idInstance&&currentUserMediaRequest.remove(o.idInstance),!i){var t=[];u.attachStreams.forEach(function(e){e.id!=o.id&&t.push(e)}),u.attachStreams=t}var e=u.streamEvents[o.streamid];if(e||(e={stream:o,streamid:o.streamid,type:i?"remote":"local",userid:u.userid,extra:u.extra,mediaElement:u.streamEvents[o.streamid]?u.streamEvents[o.streamid].mediaElement:null}),i&&u.peers[e.userid]){var n=u.peers[e.userid].peer;t=[];n.getRemoteStreams().forEach(function(e){e.id!=o.id&&t.push(e)}),u.peers[e.userid].streams=t}e.userid===u.userid&&"remote"===e.type||(u.peersBackup[e.userid]&&(e.extra=u.peersBackup[e.userid].extra),u.onstreamended(e),delete u.streamEvents[o.streamid])},!1)}},u.onMediaError=function(e,t){u.enableLogs&&console.error(e,t)},u.addNewBroadcaster=function(e,t){u.socket.isIO||(u.broadcasters.length&&setTimeout(function(){l.connectNewParticipantWithAllBroadcasters(e,t,u.broadcasters.join("|-,-|"))},1e4),u.session.oneway||u.session.broadcast||"many-to-many"!==u.direction||-1!==u.broadcasters.indexOf(e)||(u.broadcasters.push(e),i()))},u.autoCloseEntireSession=!1,u.filesContainer=u.videosContainer=document.body||document.documentElement,u.isInitiator=!1,u.shareFile=l.shareFile,void 0!==V&&V.handle(u),void 0!==F&&F.handle(u),u.token=h,u.onNewParticipant=function(e,t){u.acceptParticipationRequest(e,t)},u.acceptParticipationRequest=function(e,t){t.successCallback&&(t.successCallback(),delete t.successCallback),l.createNewPeer(e,t)},u.onShiftedModerationControl=function(e,t){u.acceptModerationControl(e,t)},u.acceptModerationControl=function(t,e){u.isInitiator=!0,u.broadcasters=e,u.peers.getAllParticipants().forEach(function(e){l.onNegotiationNeeded({changedUUID:t,oldUUID:u.userid,newUUID:t},e)}),u.userid=t,u.changeUserId(u.userid)},u.shiftModerationControl=function(e,t,n){l.onNegotiationNeeded({shiftedModerationControl:!0,broadcasters:t,firedOnLeave:!!n},e)},void 0!==A&&(u.StreamsHandler=A),u.onleave=function(e){},u.invokeSelectFileDialog=function(e){var t=new FileSelector;t.accept="*.*",t.selectSingleFile(e)},u.getPublicModerators=u.getPublicUsers=function(e,t){"function"==typeof e&&(t=e),c(function(){u.socket.emit("get-public-moderators","string"==typeof e?e:"",t)})},u.onmute=function(e){if(e&&e.mediaElement)if("both"===e.muteType||"video"===e.muteType){e.mediaElement.src=null;var t=e.mediaElement.pause();void 0!==t?t.then(function(){e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}):e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}else"audio"===e.muteType&&(e.mediaElement.muted=!0)},u.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.srcObject=e.stream,e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},u.onExtraDataUpdated=function(e){e.status="online",u.onUserStatusChanged(e,!0)},u.onJoinWithPassword=function(e){console.warn(e,"is password protected. Please join with password.")},u.onInvalidPassword=function(e,t){console.warn(e,"is password protected. Please join with valid password. Your old password",t,"is wrong.")},u.onPasswordMaxTriesOver=function(e){console.warn(e,"is password protected. Your max password tries exceeded the limit.")},u.getAllParticipants=function(e){return u.peers.getAllParticipants(e)},void 0!==A&&(A.onSyncNeeded=function(t,n,o){u.peers.getAllParticipants().forEach(function(e){l.onNegotiationNeeded({streamid:t,action:n,streamSyncNeeded:!0,type:o||"both"},e)})}),u.connectSocket=function(e){c(e)},u.closeSocket=function(){try{io.sockets={}}catch(e){}u.socket&&("function"==typeof u.socket.disconnect&&u.socket.disconnect(),"function"==typeof u.socket.resetProps&&u.socket.resetProps(),u.socket=null)},u.getSocket=function(e){return u.socket?e&&e(u.socket):c(e),u.socket},u.getRemoteStreams=l.getRemoteStreams;var s=["selectFirst","selectAll","forEach"];if(u.streamEvents={selectFirst:function(e){if(!e){var t;for(var n in u.streamEvents)-1!==s.indexOf(n)||t||(t=u.streamEvents[n]);return t}},selectAll:function(){}},u.socketURL="/",u.socketMessageEvent="RTCMultiConnection-Message",u.socketCustomEvent="RTCMultiConnection-Custom-Message",u.DetectRTC=DetectRTC,u.setCustomSocketEvent=function(e){e&&(u.socketCustomEvent=e),u.socket&&u.socket.emit("set-custom-socket-event-listener",u.socketCustomEvent)},u.getNumberOfBroadcastViewers=function(e,t){u.socket&&e&&t&&u.socket.emit("get-number-of-users-in-specific-broadcast",e,t)},u.onNumberOfBroadcastViewersUpdated=function(e){u.enableLogs&&u.isInitiator&&console.info("Number of broadcast (",e.broadcastId,") viewers",e.numberOfBroadcastViewers)},u.onUserStatusChanged=function(e,t){u.enableLogs&&!t&&console.info(e.userid,e.status)},u.getUserMediaHandler=D,u.multiPeersHandler=l,u.enableLogs=!0,u.setCustomSocketHandler=function(e){void 0!==f&&(f=e)},u.chunkSize=65e3,u.maxParticipantsAllowed=1e3,u.disconnectWith=l.disconnectWith,u.checkPresence=function(e,n){"SSEConnection"!==f.name?u.socket?u.socket.emit("check-presence",(e||u.sessionid)+"",n):u.connectSocket(function(){u.checkPresence(e,n)}):SSEConnection.checkPresence(e,function(e,t){if(!u.socket)return e||(u.userid=t),void u.connectSocket(function(){n(e,t)});n(e,t)})},u.onReadyForOffer=function(e,t){u.multiPeersHandler.createNewPeer(e,t)},u.setUserPreferences=function(e){return u.dontAttachStream&&(e.dontAttachLocalStream=!0),u.dontGetRemoteStream&&(e.dontGetRemoteStream=!0),e},u.updateExtraData=function(){u.socket.emit("extra-data-updated",u.extra)},u.enableScalableBroadcast=!1,u.maxRelayLimitPerUser=3,u.dontCaptureUserMedia=!1,u.dontAttachStream=!1,u.dontGetRemoteStream=!1,u.onReConnecting=function(e){u.enableLogs&&console.info("ReConnecting with",e.userid,"...")},u.beforeAddingStream=function(e){return e},u.beforeRemovingStream=function(e){return e},void 0!==U&&(u.checkIfChromeExtensionAvailable=U),void 0!==I&&(u.checkIfChromeExtensionAvailable=I),void 0!==N&&(u.getChromeExtensionStatus=N),u.getScreenConstraints=function(n,e){y(u,e)&&(e=!0),W(function(e,t){e||(t=u.modifyScreenConstraints(t),n(e,t))},e)},u.modifyScreenConstraints=function(e){return e},u.onPeerStateChanged=function(e){u.enableLogs&&-1!==e.iceConnectionState.search(/closed|failed/gi)&&console.error("Peer connection is closed between you & ",e.userid,e.extra,"state:",e.iceConnectionState)},u.isOnline=!0,S("online",function(){u.isOnline=!0}),S("offline",function(){u.isOnline=!1}),u.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(u.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),u.isLowBandwidth)){if(u.bandwidth={audio:!1,video:!1,screen:!1},u.mediaConstraints.audio&&u.mediaConstraints.audio.optional&&u.mediaConstraints.audio.optional.length){var n=[];u.mediaConstraints.audio.optional.forEach(function(e){void 0===e.bandwidth&&n.push(e)}),u.mediaConstraints.audio.optional=n}if(u.mediaConstraints.video&&u.mediaConstraints.video.optional&&u.mediaConstraints.video.optional.length){n=[];u.mediaConstraints.video.optional.forEach(function(e){void 0===e.bandwidth&&n.push(e)}),u.mediaConstraints.video.optional=n}}u.getExtraData=function(e){if(!e)throw"remoteUserId is required.";return u.peers[e]?u.peers[e].extra:{}},d.autoOpenOrJoin&&u.openOrJoin(u.sessionid),u.onUserIdAlreadyTaken=function(e,t){u.enableLogs&&console.warn("Userid already taken.",e,"Your new userid:",t),u.join(e)},u.onRoomFull=function(e){u.enableLogs&&console.warn(e,"is full.")},u.trickleIce=!0,u.version="3.4.5",u.onSettingLocalDescription=function(e){u.enableLogs&&console.info("Set local description for remote user",e.userid)},u.oneRoomAlreadyExist=function(e){u.enableLogs&&console.info('Server says "Room ',e,"already exist. Joining instead."),u.join(e)},u.resetScreen=function(){L=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},u.autoCreateMediaElement=!0,u.password=null}(this)};